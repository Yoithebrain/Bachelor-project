'use strict';

/*!
 * ignore
 */

const MongooseMap = require('../types/map');
const SchemaType = require('../schematype');

/*!
 * ignore
 */

class SchemaMap extends SchemaType {
  constructor(key, options) {
    super(key, options, 'Map');
    this.$isSchemaMap = true;
  }

<<<<<<< HEAD
  cast(val, doc) {
=======
  cast(val, doc, init) {
>>>>>>> dev
    if (val instanceof MongooseMap) {
      return val;
    }

<<<<<<< HEAD
=======
    if (init) {
      const map = new MongooseMap({}, this.path, doc, this.$__schemaType);

      for (const key of Object.keys(val)) {
        map.$__set(key, this.$__schemaType.cast(val[key], doc, true));
      }

      return map;
    }

>>>>>>> dev
    return new MongooseMap(val, this.path, doc, this.$__schemaType);
  }
}

module.exports = SchemaMap;
